- name: Datasources directory
  file:
    path: /etc/datasources
    state: directory
    mode: 0755
  become: true

- name: Api secrets
  template:
    src: "roles/secrets/templates/apps-api.json.j2"
    dest: "/etc/datasources/apps-api.json"
    owner: apps
    group: apps
    mode: 0400
  become: true
  diff: false

- name: IFTTT Maker token
  template:
    src: "roles/secrets/templates/ifttt-token.j2"
    dest: "/etc/datasources/ifttt-token"
    owner: apps
    group: apps
    mode: 0400
  become: true
  diff: false

- name: XMPP Server config
  template:
    src: "roles/secrets/templates/prosody.cfg.lua.j2"
    dest: "/etc/prosody/prosody.cfg.lua"
    owner: root
    group: prosody
    mode: 0640
  become: true
  diff: false
